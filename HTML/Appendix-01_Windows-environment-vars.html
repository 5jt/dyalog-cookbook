<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta charset="utf-8">
<title>EnvVars</title>
<link href="./CSS/BlackOnWhite_screen.css" rel="stylesheet" media="screen">
<link href="./CSS/Cookbook_Chapter_screen.css" rel="stylesheet" media="screen">
<link href="./CSS/snap.css" rel="stylesheet" media="screen">
<link href="./CSS/BlackOnWhite_print.css" rel="stylesheet" media="print">
<link href="./CSS/Cookbook_Chapter_print.css" rel="stylesheet" media="print">
<script src="./JavaScript/snap.js"></script>
</head>
<body>
<div class="snap-drawers">
<div class="snap-drawer snap-drawer-left">
<div class="h_tag">
<h3>Chapters</h3>
</div>
<ol>
<li><a href="./01-Introduction.html" class="external_link">Introduction</a></li>
<li><a href="./02-Structure.html" class="external_link">Structure</a></li>
<li><a href="./03-Packaging.html" class="external_link">Packaging</a></li>
<li><a href="./04-Logging%20.html" class="external_link">Logging </a></li>
<li><a href="./05-Configuration.html" class="external_link">Configuration</a></li>
<li><a href="./06-Debugging-EXEs.html" class="external_link">Debugging EXEs</a></li>
<li><a href="./07-Handling-errors.html" class="external_link">Handling errors</a></li>
<li><a href="./08-Testing.html" class="external_link">Testing</a></li>
<li><a href="./09-Documentation.html" class="external_link">Documentation</a></li>
<li><a href="./10-Make.html" class="external_link">Make</a></li>
<li><a href="./11-Providing-help.html" class="external_link">Providing help</a></li>
<li><a href="./12-Scheduled-Tasks.html" class="external_link">Scheduled Tasks</a></li>
<li><a href="./13-Windows-Services.html" class="external_link">Windows Services</a></li>
<li><a href="./14-Windows-Event-Log.html" class="external_link">Windows Event Log</a></li>
<li><a href="./15-Windows-Registry.html" class="external_link">Windows Registry</a></li>
<li><a href="./16-Creating-SetUp.exe.html" class="external_link">Creating SetUp.exe</a></li>
<li><a href="./17-Regular-Expressions.html" class="external_link">Regular Expressions</a></li>
<li><a href="./18-Acre.html" class="external_link">Acre</a></li>
<li><a href="./19-GUI.html" class="external_link">GUI</a></li>
<li><a href="./20-Git.html" class="external_link">Git</a></li>
</ol>
<div class="h_tag">
<h3>Appendices</h3>
</div>
<ol>
<li><a href="./Appendix-01_Windows-environment-vars.html" class="external_link">Windows environment vars</a></li>
<li><a href="./Appendix-02_User-commands.html" class="external_link">User commands</a></li>
<li><a href="./Appendix-03_aplcores-&-WS-integrity.html" class="external_link">aplcores & WS integrity</a></li>
<li><a href="./Appendix-04_Development-environment.html" class="external_link">Development environment</a></li>
<li><a href="./Appendix-05_Special-characters.html" class="external_link">Special characters</a></li>
</ol>
<div class="h_tag">
<h3>Misc</h3>
</div>
<ul>
<li><a href="20-Git.html">Previous chapter</a></li>
<li><a href="Appendix-02_User-commands.html">Next chapter</a></li>
<li><a href="./Dyalog_Cookbook.html" class="external_link" alt="All chapters, for printing" title="All chapters, for printing">Single document<br></a></li>
</ul>
</div>
</div>
<div id="mainmenu">
<a href=# style="color:black;"><p><span id="mainmenu_match">≡</span></p></a>
<p><span id="mainmenu_title">The Dyalog Cookbook</span></p>
</div>
<div id="content" class="snap-content">
<div id="cookbook_content">
<div class="h_tag">
<a href="#21-Appendix-1-----Windows-environment-variables" id="21-Appendix-1-----Windows-environment-variables" class="autoheader_anchor">
<h1>21. Appendix 1 — Windows environment variables</h1>
</a>
</div>
<div class="h_tag">
<a href="#Overview" id="Overview" class="autoheader_anchor">
<h2>Overview</h2>
</a>
</div>
<p>Windows comes with quite a number of environment variables. Those variables are helpful in addressing, say, a particular path without actually using a physical path.</p>
<p>For example, on most PCs, Windows is installed in C:\Windows, but this is by no means guaranteed. It is therefore much better to address this particular folder as <code>⊣2 ⎕NQ # 'GetEnvironment' 'WINDIR'</code>.</p>
<p>Below some of the environment variables found on a Windows 10 system are listed and explained.</p>

<div class="leanpub">
<img src="https://download.aplwiki.com/LeanPub/Images/information.png" alt="Information">
<div>
<p>The Dyalog Cookbook is usually referring to Windows 10 which, in most cases, is identical with Windows 8 and 7. The Cookbook is not applicable to unsupported versions of Windows like Vista and earlier.</p>
</div>
</div>

<p>Notes:</p>
<ul>
<li>When something like “{this}” is part of a path then it means that this string has to be exchanged for something reasonable. For example, in “C:/Users/{yourName}/” the string “{yourName}” needs to be replaced by the value of <code>⎕AN</code>.</li>
<li>The list of environment variables discussed in this appendix is by no means exhaustive.</li>
<li>Under Windows, the names of environment variables are case-insensitive.</li>
</ul>
<div class="h_tag">
<a href="#Outdated" id="Outdated" class="autoheader_anchor">
<h2>Outdated?!</h2>
</a>
</div>
<p>Some consider environment variables an outdated technology. We don't want to get involved in this argument here but enviroment variables will be round for a very long time, and Windows relies on them. (They are also standard under UNIX, including Linux and MacOS.)</p>
<div class="h_tag">
<a href="#The-variables" id="The-variables" class="autoheader_anchor">
<h2>The variables</h2>
</a>
</div>
<div class="h_tag">
<a href="#AllUserProfile" id="AllUserProfile" class="autoheader_anchor">
<h3><code>AllUserProfile</code></h3>
</a>
</div>
<p>Defaults to <code>C:\ProgramData</code>: see <a href="#programdata" class="bookmark_link"><code>ProgramData</code></a></p>
<div class="h_tag">
<a href="#AppData" id="AppData" class="autoheader_anchor">
<h3><code>AppData</code></h3>
</a>
</div>
<p>Defaults to <code>C:\Users\{yourName}\AppData\Roaming</code></p>
<p>Use this to store data that is both application <strong>and</strong> user specific that is supposed to roam [<a href="#fnref2" class="footnote_link"><sup>2</sup></a>] with the user. An <abbr title="File with the extension 'ini' containing configuration data">INI</abbr> might be an example.</p>
<p>See also <strong><a href="#localappdata" class="bookmark_link"><code>LocalAppData</code></a></strong></p>
<div class="h_tag">
<a href="#CommonProgramFiles" id="CommonProgramFiles" class="autoheader_anchor">
<h3><code>CommonProgramFiles</code></h3>
</a>
</div>
<p>Defaults to <code>C:\Program Files\Common Files</code></p>
<div class="h_tag">
<a href="#CommonProgramFiles-1" id="CommonProgramFiles-1" class="autoheader_anchor">
<h3><code>CommonProgramFiles(x86)</code></h3>
</a>
</div>
<p>Defaults to <code>C:\Program Files (x86)\Common Files</code></p>
<div class="h_tag">
<a href="#CommonProgramW6432" id="CommonProgramW6432" class="autoheader_anchor">
<h3><code>CommonProgramW6432</code></h3>
</a>
</div>
<p>Defaults to <code>C:\Program Files\Common Files</code></p>
<div class="h_tag">
<a href="#ComputerName" id="ComputerName" class="autoheader_anchor">
<h3><code>ComputerName</code></h3>
</a>
</div>
<p>The name of the computer</p>
<div class="h_tag">
<a href="#ComSpec" id="ComSpec" class="autoheader_anchor">
<h3><code>ComSpec</code></h3>
</a>
</div>
<p>Defaults to <code>C:\WINDOWS\system32\cmd.exe</code></p>
<div class="h_tag">
<a href="#ErrorLevel" id="ErrorLevel" class="autoheader_anchor">
<h3><code>ErrorLevel</code></h3>
</a>
</div>
<p>This variable does not necessarily exist. If you execute <code>⎕OFF 123</code> in an APL application it will set <code>ErrorLevel</code> to 123.</p>
<div class="h_tag">
<a href="#HomeDrive" id="HomeDrive" class="autoheader_anchor">
<h3><code>HomeDrive</code></h3>
</a>
</div>
<p>Carries the drive letter and a colon (like <code>C:</code>) but only if the user's data (documents, downloads, music…) do not live on a UCN path; for that see <a href="#HomeShare" class="bookmark_link"><code>HomeShare</code></a>.</p>
<div class="h_tag">
<a href="#HomePath" id="HomePath" class="autoheader_anchor">
<h3><code>HomePath</code></h3>
</a>
</div>
<p>Defaults to <code>\Users\{yourName}</code>. Note that this means it comes <strong>without</strong> the drive letter or UNC path! For a full path you need also either <a href="#HomeDrive" class="bookmark_link"><code>HomeDrive</code></a> or <a href="#HomeShare" class="bookmark_link"><code>HomeShare</code></a>.</p>
<p>See also <a href="#UserProfile" class="bookmark_link"><code>USERPROFILE</code></a> which is usually identical with <a href="#HomePath" class="bookmark_link"><code>HOMEPATH</code></a>[<a href="#fnref1" class="footnote_link"><sup>1</sup></a>] but comes <strong>with</strong> the drive letter.</p>
<div class="h_tag">
<a href="#HomeShare" id="HomeShare" class="autoheader_anchor">
<h3><code>HomeShare</code></h3>
</a>
</div>
<p>This variable exists only of the user's data (documents, downloads, music…) live on a UNC path. See also <a href="#HomeShare" class="bookmark_link"><code>HomePath</code></a>.</p>
<div class="h_tag">
<a href="#localappdata" id="localappdata" class="autoheader_anchor">
<h3><code>LocalAppData</code></h3>
</a>
</div>
<p>Defaults to <code>C:\Users\{yourName}\AppData\Local</code></p>
<p>Use this to store data that is both application <strong>and</strong> user specific that is <strong>not</strong> supposed to roam [<a href="#fnref2" class="footnote_link"><sup>2</sup></a>] with the user.</p>
<p>A log file might be an example. The reason is that when a user logs in all the data stored in <a href="#AppData" class="bookmark_link"><code>APPDATA</code></a> is copied over. A large log file might take significant time to be copied with very little (or no) benefit.</p>
<p>See also <strong><a href="#AppData" class="bookmark_link"><code>AppData</code></a></strong>.</p>
<div class="h_tag">
<a href="#LogonServer" id="LogonServer" class="autoheader_anchor">
<h3><code>LogonServer</code></h3>
</a>
</div>
<p>Defaults to the name of the computer your are logged on to. In case of your own desktop PC the values of <code>LogonServer</code> and <a href="#ComputerName" class="bookmark_link"><code>ComputerName</code></a> will be the same. In a Windows Server Domain however they will differ.</p>
<div class="h_tag">
<a href="#OS" id="OS" class="autoheader_anchor">
<h3><code>OS</code></h3>
</a>
</div>
<p>Specifies the Operating System; under Windows 10, <code>Windows_NT</code></p>
<div class="h_tag">
<a href="#Path" id="Path" class="autoheader_anchor">
<h3><code>Path</code></h3>
</a>
</div>
<p>All the folders (separated by semicola) that the operating system should check if the user enters something like <code>my.exe</code> into a console window and <code>my.exe</code> is not found in the current directory.</p>
<div class="h_tag">
<a href="#PathExt" id="PathExt" class="autoheader_anchor">
<h3><code>PathExt</code></h3>
</a>
</div>
<p>A list of the file extensions the operating system considers executable, for example: <code>.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC</code>.</p>
<div class="h_tag">
<a href="#programdata" id="programdata" class="autoheader_anchor">
<h3><code>ProgramData</code></h3>
</a>
</div>
<p>Defaults to <code>C:\ProgramData</code>. Use this for information that is application-specific and needs write access after installation. For Dyalog, this would be the right place to store the session file, workspaces and user commands.</p>
<div class="h_tag">
<a href="#programfiles" id="programfiles" class="autoheader_anchor">
<h3><code>ProgramFiles</code></h3>
</a>
</div>
<p>Defaults to <code>C:\Program Files</code>. On a 64-bit version of Windows this is where 64-bit programs are installed. Note however that on a 32-bit version of Windows this points to <a href="#x86" class="bookmark_link"><code>ProgramFiles(x86)</code></a>.</p>
<div class="h_tag">
<a href="#x86" id="x86" class="autoheader_anchor">
<h3><code>ProgramFiles(x86)</code></h3>
</a>
</div>
<p>Defaults to <code>C:\Program Files (x86)</code>. This is where 32-bit programs are installed.</p>
<div class="h_tag">
<a href="#ProgramW6432" id="ProgramW6432" class="autoheader_anchor">
<h3><code>ProgramW6432</code></h3>
</a>
</div>
<p>Defaults to <code>C:\Program Files</code>. On a 64-bit version of Windows this path points to <a href="#programfiles" class="bookmark_link"><code>ProgramFiles</code></a>. On a 32-bit version of Windows it also points to <code>ProgramFiles</code> which in turn points to <a href="#x86" class="bookmark_link"><code>ProgramFiles(x86)</code></a>.</p>
<p>For details see <em>WOW64 Implementation Detail</em> [<a href="#fnref4" class="footnote_link"><sup>4</sup></a>].</p>
<div class="h_tag">
<a href="#PSModulePath" id="PSModulePath" class="autoheader_anchor">
<h3><code>PSModulePath</code></h3>
</a>
</div>
<p>Defaults to <code>C:\WINDOWS\system32\WindowsPowerShell\v1.0\Modules\</code>. This path is used by Windows Power Shell [<a href="#fnref3" class="footnote_link"><sup>3</sup></a>] to locate modules when the user does not specify the full path to a module.</p>
<div class="h_tag">
<a href="#Public" id="Public" class="autoheader_anchor">
<h3><code>Public</code></h3>
</a>
</div>
<p>Defaults to <code>C:\Users\Public</code>. It contains folders like <code>\Public Documents</code>, <code>\Public Music</code>, <code>\Public Pictures</code>, <code>\Public Videos</code>, … well, you get the picture.</p>
<div class="h_tag">
<a href="#systemroot" id="systemroot" class="autoheader_anchor">
<h3><code>SystemRoot</code></h3>
</a>
</div>
<p>Specifies the folder in which Windows is installed. Defaults to <code>C:\WINDOWS</code>.</p>
<div class="h_tag">
<a href="#Temp" id="Temp" class="autoheader_anchor">
<h3><code>Temp</code></h3>
</a>
</div>
<p>Points to the folder that holds temporary files and folders. Defaults to <code>C:\Users\{username}\AppData\Local\Temp</code>. See also <a href="#TMP" class="bookmark_link"><code>TMP</code></a>.</p>
<div class="h_tag">
<a href="#TMP" id="TMP" class="autoheader_anchor">
<h3><code>TMP</code></h3>
</a>
</div>
<p>Points to the folder that holds temporary files and folders. Defaults to <code>C:\Users\{username}\AppData\Local\Temp</code>. Note that the <code>GetTempFileName</code> API function (which is available as <code>FilesAndDirs.GetTempFilename</code>) will first look for the <code>TMP</code> environment variable and only if that does not exist for the <a href="#Temp" class="bookmark_link"><code>TEMP</code></a> variable.</p>
<div class="h_tag">
<a href="#Username" id="Username" class="autoheader_anchor">
<h3><code>Username</code></h3>
</a>
</div>
<p>The username of the user currently logged on. Same as <code>⎕AN</code> in APL.</p>
<div class="h_tag">
<a href="#UserProfile" id="UserProfile" class="autoheader_anchor">
<h3><code>UserProfile</code></h3>
</a>
</div>
<p>Defaults to <code>C:\Users\{username}</code>. That's where everything is saved that belongs to the user currently logged on.</p>
<p>This is usally identical[<a href="#fnref1" class="footnote_link"><sup>1</sup></a>] to <a href="#HomePath" class="bookmark_link"><code>HomePath</code></a> except that <code>HomePath</code> does not carry the drive letter.</p>
<div class="h_tag">
<a href="#WinDir" id="WinDir" class="autoheader_anchor">
<h3><code>WinDir</code></h3>
</a>
</div>
<p>Defaults to the value of <a href="#systemroot" class="bookmark_link"><code>SystemRoot</code></a>. Deprecated.</p>
<div id="footnotes_div">
<hr>
<p><strong>Footnotes</strong></p>
<ol>
<li id="fnref1"><p>The difference between <code>HomeDrive|HomeShare\HomePath</code> and <code>UserProfile</code> is that <em>usually</em> they are the same. However, it is possible — and relatively simple — to put the user's data (<code>HomePath\*</code>) elsewhere, a network drive for example. <code>UserProfile</code> however is where the user's profile is loaded from, and that cannot be changed.</p><p>Note that it is possible to have no profile loaded, but this is a very special — and rare — case. Google for it when you run into this.</p><a href="#fnref1" class="footnote_anchor"></a>
<li id="fnref2"><p><a href="https://en.wikipedia.org/wiki/Roaming_user_profile" class="external_link">https://en.wikipedia.org/wiki/Roaming_user_profile</a></p><a href="#fnref2" class="footnote_anchor"></a>
<li id="fnref3"><p><a href="https://en.wikipedia.org/wiki/PowerShell" class="external_link">https://en.wikipedia.org/wiki/PowerShell</a></p><a href="#fnref3" class="footnote_anchor"></a>
<li id="fnref4"><p><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa384274(v=vs.85).aspx" class="external_link">https://msdn.microsoft.com/en-us/library/windows/desktop/aa384274(v=vs.85).aspx</a></p><a href="#fnref4" class="footnote_anchor"></a>
</ol>
</div>
</div>
</div>
<script>
var snapper = new Snap({
element: document.getElementById('content')
});
document.getElementById('mainmenu_match').onclick = function(){
snapper.state().state==='closed'?snapper.open('left'):snapper.close();
}
</script>
</body>
</html>