<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta charset="utf-8">
<title>Meddy</title>
<style media="screen">
html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;}body{margin:0;}article,aside,footer,header,nav,section{display:block;}h1{font-size:2em;margin:0.67em 0;}figcaption,figure,main{display:block;}figure{margin:1em 40px;}hr{box-sizing:content-box;height:0;overflow:visible;}pre{font-family:monospace, monospace;font-size:1em;}a{background-color:transparent;-webkit-text-decoration-skip:objects;}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted;}b,strong{font-weight:inherit;}b,strong{font-weight:bolder;}code,kbd,samp{font-family:monospace, monospace;font-size:1em;}dfn{font-style:italic;}mark{background-color:#ff0;color:#000;}small{font-size:0.8em;}sub,sup{font-size:0.75em;line-height:0;position:relative;vertical-align:baseline;}sub{bottom:-0.25em;}sup{top:-0.5em;}audio,video{display:inline-block;}audio:not([controls]){display:none;height:0;}img{border-style:none;}svg:not(:root){overflow:hidden;}button,input,optgroup,select,textarea{font-family:sans-serif;font-size:1em;line-height:1.15;margin:0;}button,input{overflow:visible;}button,select{text-transform:none;}button,html [type="button"], [type="reset"],[type="submit"]{-webkit-appearance:button;}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{border-style:none;padding:0;}button:-moz-focusring,[type="button"]:-moz-focusring,[type="reset"]:-moz-focusring,[type="submit"]:-moz-focusring{outline:1px dotted ButtonText;}fieldset{padding:0.35em 0.75em 0.625em;}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal;}progress{display:inline-block;vertical-align:baseline;}textarea{overflow:auto;}[type="checkbox"],[type="radio"]{box-sizing:border-box;padding:0;}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{height:auto;}[type="search"]{-webkit-appearance:textfield;outline-offset:-2px;}[type="search"]::-webkit-search-cancel-button,[type="search"]::-webkit-search-decoration{-webkit-appearance:none;}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit;}details, menu{display:block;}summary{display:list-item;}canvas{display:inline-block;}template{display:none;}[hidden]{display:none;}body{margin:0;font-family:"Bookman Old Style", "Callisto MT", Bookman, "Goudy Old Style", Garamond, serif;background-color:#fdfdfd;font-size:18px;line-height:1.4;max-width:none;padding:0.83em;color:#292929;}h1, h2, h3, h4, h5, h6{color:#404040;font-weight:800;padding-left:0;}h1, h2, h3, h4, h5, h6{font-family:"Century Gothic", Verdana, "Sans";}h1, h2, h3, h4, p{margin-bottom:0.88em;}h1{font-size:1.8em;margin:0.27em 0 1.11em 0;}h1 > code, h2 > code, h3 > code, h4 > code, h5 > code, h6 > code{font-size:1em;background-color:inherit;}h2{font-size:1.44em;margin:0.55em 0 0.55em 0;padding-top:0.55em;border-bottom:1px solid Silver;}h3{margin:0;margin-top:0.55em;font-size:1.22em;}nav h3{font-size:0.88em;margin-left:0.83em;margin-bottom:0.27em;}h4{font-size:1em;margin:0;margin-top:0.55em;}h5{font-size:0.94em;margin:0;margin-top:0.66em;padding:0;}h6{font-size:0.88em;margin:0;margin-top:0.66em;padding:0;}a{color:#0099ff;margin:0;padding:0;vertical-align:baseline;}a:visited{color:purple;}a.autoheader_anchor{text-decoration:none;}ul{list-style-type:disc;}ul, ol{padding:0;margin:0;}dd{padding-top:0.25em;}p.first_dd{padding-top:0.25em;}li > ul, ol{padding-bottom:0;}li{line-height:1.3;margin-left:1.38em;margin-bottom:0.55em;}ul > li{margin-left:1.11em;}li ul{margin-left:0.55em;}li ul{margin-left:0.27em;}li p{padding:1px 0 0 0;margin:0.55em 0 0.27em 0;line-height:1.3;}p, ul, ol{line-height:1.3;padding:0.44em 0 0 0;margin:0;}pre{overflow:scroll;padding:0.55em 0.27em;margin:0.55em 0 0.55em 0 !important;background-color:#faebd7;color:#3e3e3e;border:1px Silver dashed;display:block;font-family:APLFont, monospace;font-weight:400;}pre > code{line-height:1.2;border:0;padding:0;margin:0;background-color:inherit;color:inherit;font-weight:inherit;}a code{padding:0;font-size:1em;}nav code{background-color:inherit;font-weight:400;color:inherit;}code{font-family:APLFont, monospace;background-color:#e7e7e7;color:Black;font-weight:800;line-height:1.2;font-size:0.88em;margin:0;color:#950000;padding:0 0.16em;}tbody tr:nth-child(even){background-color:#F0F0F0;}th{background-color:#E6E6E6;color:black;}th, td{padding:0.16em 0.55em;}table{border-color:Black;margin:1.11em 0 1.11em 0;border:2px black;border-collapse:collapse;font-family:APLFont;font-size:0.88em;line-height:1.2;border:1px solid Gray;}li > table{margin:0.55em 0 0.55em 0;}tr{margin:1.11em;}th{font-weight:bold;}tfoot td{font-weight:bold;}blockquote{border-left:0.27em solid silver;padding-left:0.27em;margin:0.83em 0.27em 0.83em 0.55em;}blockquote ul li{margin-left:1.38em;}blockquote ol li{margin-left:1.38em;}li > blockquote{margin-left:0;}nav{background-color:#f5f5f5;border:1px solid Black;padding:0.55em;margin:0.55em;margin-right:0;box-shadow:0.27em 0.27em 0.27em Gray;overflow:hidden;}nav#main_nav{position:fixed;top:0;right:0.55em;float:none;width:auto;}nav#main_nav_no_collapse li{font-size:0.77rem;}nav#main_nav_no_collapse li{line-height:1.5;}nav ul{list-style-type:none;margin:0 0 0.11em 0;padding:0;}nav a:visited{color:black;}nav ul li{margin-bottom:0.16em;}nav li p{margin:0;padding:0;line-height:1;margin:0;padding:0;}nav li{font-size:0.75rem;line-height:1.3;padding:0;margin-top:0;margin-bottom:0;margin-left:0.83em;}nav p{font-weight:bold;font-size:0.75rem;padding-top:0;}dl{margin-top:0.1em;margin-bottom:0.1em;}dt{margin-top:0.75em;margin-bottom:0.1em;font-weight:800;}label#hide_toc_label{font-size:0.8em;}.toc-container{position:relative;height:auto;}div.toc-container h1{font-size:0.88em;margin:0.27em 0 0.27em 0;}[type="checkbox"]{position:absolute;left:-9999px;}label{display:block;width:100%;height:1.1em;cursor:pointer;top:0;padding-left:1.1em;}label:before{content:'Table of contents \25BC';font-weight:bold;font-size:90%;padding-bottom:0;}[type="checkbox"] ~ div{display:none;}[type="checkbox"]:checked ~ div{display:block;margin-top:1.1em;}[type="checkbox"]:checked + label{top:100%;}[type="checkbox"]:checked + label:before{content:'Table of contents ‚ñ≤';}div#footnotes_div p{line-height:1;padding-bottom:0;padding-top:0;}div#footnotes_div ol{padding-top:0;}@font-face{font-family:"APLFont";src:local("APL385 Unicode"), url("http://misc.aplteam.com/apl385.ttf") format("truetype");}.no_display{display:none;}.red{color:red;}img{margin-top:0.55em;margin-bottom:0.27em;}div.leanpub{padding:0.83em 0.55em 1.11em 0;margin:0.55em 0 0 0.27em;overflow:auto;}div.leanpub_A{border:1px solid black;background-color:#f1f1f1;padding:0.55em;margin:1.11em 0 0.83em 0;}div.leanpub h3, div.leanpub_A h3{font-size:1.2em;padding:0;margin:0;}div.leanpub h4, div.leanpub_A h4{font-size:1.1em;padding:0.27em 0 0 0;margin:0;}div.leanpub h5, div.leanpub h5{font-size:1.0em;padding:0.27em 0 0 0;margin:0;}div.leanpub_A h5, div.leanpub_A h5{font-size:1.0em;padding:0.27em 0 0 0;margin:0;}div.leanpub img{padding:0;margin:0 1.11em 0.27em 0;}div.leanpub_A > p:first-child{padding-top:0;margin-top:0;}div.leanpub img{float:left;padding:0;margin:0.55em 1.11em 0 0;clear:both;}div.leanpub tbody *{background-color:transparent;}div.leanpub p{padding:0.17em 0 0 0;margin:0;}span.leanpub_code{color:Red;}div.leanpub p{display:block;padding:0.44em 0 0 0;}div.leanpub > div{margin-left:2.27em;}
</style>
<style media="print">
@page{margin:25mm 20mm 25mm 20mm;}body{font-family:"Bookman Old Style", "Callisto MT", Bookman,"Goudy Old Style", Garamond, serif;font-size:9pt;line-height:1.2;}h1{font-size:170%;}h2{font-size:110%;}h3{font-size:110%;}h4{font-size:105%;}h5{font-size:100%;}h6{font-size:95%;}h1{margin:0 0 20pt 0;}h2{margin:15pt 0 3pt 0;}h3{margin:10pt 0 0pt 0;}h4{margin:10pt 0 0pt 0;}h5{margin:9pt 0 0pt 0;}h6{margin:9pt 0 0pt 0;}h1, h2, h3, h4, h5, h6{color:black;font-family:"Century Gothic", Verdana, "Sans";page-break-after:avoid;}h1 > code, h2 > code, h3 > code, h4 > code, h5 > code, h6 > code{font-size:100%;}h2{border-bottom:1pt solid Silver;padding-bottom:2pt;}.h_tag{page-break-after:avoid;break-after:avoid;}abbr[title]{border-bottom:0;text-decoration:none;}a{color:black;margin:0;padding:0;vertical-align:baseline;text-decoration:none;font-style:italic;}a.autoheader_anchor{text-decoration:none;font-style:normal;page-break-after:avoid;break-after:avoid;}ul{list-style-type:square;}ul, ol{padding:0;margin:0;}li > ul, ol{padding-bottom:0;}li{line-height:1.3;margin-left:13pt;margin-bottom:5pt;}ul > li{margin-left:10pt;}li ul{margin-left:5pt;}li ul{margin-left:3pt;}li p{padding:1pt 0 0 0;margin:5pt 0 3pt 0;line-height:1.3;}p, ul, ol{line-height:1.3;padding:4pt 0 0 0;margin:0;color:black;}pre{padding:3pt;margin:5pt 0;white-space:pre-wrap;background-color:#FAFAFA;border:1pt Silver solid;display:block;font-family:APLFont, monospace;page-break-inside:avoid;-webkit-print-color-adjust:exact;}pre code{background-color:#FAFAFA;color:Black;padding:0;margin:0 0 -6pt 0;line-height:1.1;border:0;}code{font-family:APLFont, monospace;line-height:1.2;font-size:9pt;padding:3pt 1pt 3pt 1pt;color:#950000;padding:3pt 4pt 3pt 4pt;}tbody th, tfoot tr{background-color:#e6e6e6;}tbody tr:nth-child(even){background-color:#fafafa;}th{background-color:#F0F0F0;}th, td{padding:1pt 5pt;}table{margin:10pt 0;font-family:APLFont;font-size:9pt;padding:0;border:1pt solid silver;-webkit-print-color-adjust:exact;}li > table{margin:10pt 0 10pt 0;}tr{margin:20pt;}th{font-weight:bold;}tfoot td{font-weight:bold;}blockquote{border-left:5pt solid silver;padding-left:5pt;margin:8pt 3pt 8pt 8pt;}nav{background-color:#f8f8f8;border:1pt solid Gray;width:auto;float:right;padding:5pt 5pt 5pt 0;margin:5pt 0 5pt 5pt;page-break-inside:avoid;}nav *{font-size:75%;}nav ul{list-style-type:none;margin:0 0 2pt 0;padding:0;}nav ul li{margin-bottom:0;}nav li p{margin:0;padding:0;line-height:1;margin:0;padding:0;}nav li{font-size:9pt;line-height:1;padding:0;margin-top:0;margin-bottom:0;margin-left:8pt;}dl{margin-top:0;margin-bottom:10pt;}dt{margin-top:10pt;margin-bottom:0;font-weight:800;page-break-inside:avoid;}dd{margin-top:2pt;}label#hide_toc_label{font-size:65%;}.toc-container{position:relative;height:auto;margin-top:5pt;}.toc-container h1{margin:0 0 7pt 7pt;}[type="checkbox"]{display:none;}label{display:block;width:100%;height:1.1em;top:0;padding-left:10pt;}label:before{content:'Table of contents';font-weight:bold;font-size:140%;padding-bottom:10pt;}a.external_link::before{content:" üåé";}a.bookmark_link::before{content:" ‚ûØ";}a.mailto_link::before{content:" ‚úâ"}nav a.bookmark_link{font-style:normal;}nav p{margin-left:10pt;font-weight:bold;font-size:9pt;}nav a{font-style:normal;}nav a.bookmark_link::before{content:"";}div#footnotes_div a::before{content:"";}div#footnotes_div a{font-style:normal;}div#footnotes_div{page-break-inside:avoid;}@font-face{font-family:"APLFont";src:local("APL385 Unicode"), url("http://misc.aplteam.com/apl385.ttf") format("truetype");}.no_print{display:none;}.red{color:red;}.avoid_page_break{page-break-inside:avoid;}.page_break_before{page-break-before:auto;}div.leanpub{margin:10pt 0 10pt 8pt;page-break-inside:avoid;}div.leanpub_A{border:1pt solid black;background-color:#f9f9f9;padding:5pt;margin:10pt 0 10pt 0;page-break-inside:avoid;}div.leanpub h3, div.leanpub_A h3{font-size:1.2em;padding:3pt 0 0 0;margin:0;}div.leanpub h4, div.leanpub_A h4{font-size:1.1em;padding:3pt 0 0 0;margin:0;}div.leanpub h5, div.leanpub h5{font-size:1.0em;padding:3pt 0 0 0;margin:0;}div.leanpub_A h5, div.leanpub_A h5{font-size:1.0em;padding:3pt 0 0 0;margin:0;}div.leanpub img{padding:0;margin:0 10pt 2pt 0;}div.leanpub_A > p:first-child{padding-top:0;margin-top:0;}div.leanpub > div > h1:first-child{padding-top:5pt;}div.leanpub img{float:left;padding:0;margin:5pt 10pt 0 0;clear:both;}div.leanpub p{padding:3pt 0 0 0;margin:0;}span.leanpub_code{color:black;}div.leanpub p{display:block;padding:8pt 0 0 0;}div.leanpub > div{margin-left:35pt;}
</style>
<meta name="author" content="kai">
</head>
<body>
<nav id="main_nav_no_collapse">
<div class="toc-container">
<h3>Table of contents</h3>
<ul>
<li><a href="#Why-you-want-to-write-tests">Why you want to write tests</a>
<ul>
<li><a href="#Notice-when-you-break-things">Notice when you break things</a></li>
<li><a href="#More-reliable-than-documentation">More reliable than documentation</a></li>
<li><a href="#Understand-more">Understand more</a></li>
</ul></li>
<li><a href="#Readability">Readability</a>
<ul>
<li><a href="#Write-better">Write better</a></li>
</ul></li>
<li><a href="#Why-you-dont-want-to-write-tests">Why you don‚Äôt want to write tests</a></li>
<li><a href="#Setting-up-the-test-environment">Setting up the test environment</a></li>
<li><a href="#Unit-and-functional-tests">Unit and functional tests</a></li>
<li><a href="#Speed">Speed</a></li>
<li><a href="#Preparing-helpers">Preparing: helpers</a>
<ul>
<li><a href="#Flow-control-helpers">Flow control helpers</a></li>
</ul></li>
<li><a href="#Writing-unit-tests">Writing unit tests</a>
<ul>
<li><a href="#The-Initial-function">The ‚ÄúInitial‚Äù function</a></li>
<li><a href="#Cleaning-up">Cleaning up</a></li>
<li><a href="#Markers">Markers</a></li>
<li><a href="#The-L-and-G-helpers">The ‚ÄúL‚Äù and ‚ÄúG‚Äù helpers</a></li>
</ul></li>
<li><a href="#TestCasesExecutedAt">TestCasesExecutedAt</a></li>
<li><a href="#Conclusion">Conclusion</a></li>
<li><a href="#The-sequence-of-tests">The sequence of tests</a></li>
<li><a href="#Testing-in-different-versions-of-Windows">Testing in different versions of Windows</a></li>
<li><a href="#Testing-APLTree-modules">Testing APLTree modules</a>
</ul>
</div>
</nav>
<p>1{:: encoding=‚Äúutf-8‚Äù /} [parm]:title='Testing'</p>
<div class="h_tag">
<a href="#Testing--the-sound-of-breaking-glass" id="Testing--the-sound-of-breaking-glass" class="autoheader_anchor">
<h1>Testing ‚Äì the sound of breaking glass</h1>
</a>
</div>
<p>Our application here is simple ‚Äì¬†just count letter frequency in text files.</p>
<p>All the other code has been written to configure the application, package it for shipment, and to control how it behaves when it encounters problems.</p>
<p>Developing code refines and extends it. We have more developing to do. Some of that developing might break what we already have working. Too bad. No one‚Äôs perfect.</p>
<p>But we would at least like to know when we‚Äôve broken something ‚Äì¬†to hear the sound of breaking glass behind us. Then we can fix the error before going any further.</p>
<p>In our ideal world we would have a team of testers continually testing and retesting our latest build to see if it still does what it‚Äôs supposed to do. The testers would tell us if we broke anything. In the real world we have programs ‚Äì¬†tests ‚Äì¬†to do that.</p>
<p>What should we write tests for? ‚ÄúAnything you think might break,‚Äù says Kent Beck[<a href="#fnref1" class="footnote_link"><sup>1</sup></a>], author of <em>Extreme Programming Explained</em>. We‚Äôve already written code to allow for ways in which the file system might misbehave. We should write tests to discover if that code works. We‚Äôll eventually discover conditions we haven‚Äôt foreseen and write fixes for them. Then those conditions too will join the things we think might break, and get added to the test suite.</p>
<div class="h_tag">
<a href="#Why-you-want-to-write-tests" id="Why-you-want-to-write-tests" class="autoheader_anchor">
<h2>Why you want to write tests</h2>
</a>
</div>
<div class="h_tag">
<a href="#Notice-when-you-break-things" id="Notice-when-you-break-things" class="autoheader_anchor">
<h3>Notice when you break things</h3>
</a>
</div>
<p>Some functions are more vulnerable than others to being broken under maintenance. Many functions are written to encapsulate complexity, bringing a common order to a range of different arguments.</p>
<p>For example, you might write a function that takes as argument any of a string[<a href="#fnref2" class="footnote_link"><sup>2</sup></a>], a vector of strings, a character matrix or a matrix of strings.</p>
<p>If you later come to define another case, say, a string with embedded line breaks, it‚Äôs easy enough inadvertently to change the function‚Äôs behaviour with the original cases.</p>
<p>If you have tests that check the function‚Äôs results with the original cases, it‚Äôs easy to ensure your changes don't change the results unintentionally.</p>
<div class="h_tag">
<a href="#More-reliable-than-documentation" id="More-reliable-than-documentation" class="autoheader_anchor">
<h3>More reliable than documentation</h3>
</a>
</div>
<p>No, tests don‚Äôt replace documentation. They don‚Äôt convey your intent in writing a class or function. They don‚Äôt record your ideas for how it should and should not be used, references you consulted before writing it, or thoughts about how it might later be improved.</p>
<p>But they do document with crystal clarity what it is <em>known</em> to do. In a naughty world in which documentation is rarely complete and even less often revised when the code is altered, it has been said the <em>only</em> thing we know with certainty about any given piece of software is what tests it passes.</p>
<div class="h_tag">
<a href="#Understand-more" id="Understand-more" class="autoheader_anchor">
<h3>Understand more</h3>
</a>
</div>
<p>Test-Driven Design (TDD) is a high-discipline practice associated with Extreme Programming. TDD tells you to write the tests <em>before</em> you write the code. Like all such rules, we recommend following TDD ‚Äì thoughtfully.</p>
<p>The reward from writing an automated test is not <em>always</em> worth the effort. But it is a very good practice and we recommend it given that the circumstances are right.</p>
<p>For example, if you know from the start <em>exactly</em> what your program is supposed to do then TDD is certainly an option. If you start prototyping in order to find out what the user actually wants the program to do, TDD is no option at all.</p>
<p>If you are writing the first version of a function, writing the tests first will clarify your understanding of what the code should be doing. It will also encourage you to consider boundary cases or edge conditions: for example, how should the function above handle an empty string? A character scalar?</p>
<p>TDD first tests your understanding of your task. If you can't define tests for your new function, perhaps you‚Äôre not ready to write the function either.</p>
<p>If you are modifying an existing function, write new tests for the new things it is to do. Run the revised tests and see that the code fails the new tests. If the unchanged code <em>passes</em> any of the new tests‚Ä¶ review your understanding of what you‚Äôre trying to do!</p>
<div class="h_tag">
<a href="#Readability" id="Readability" class="autoheader_anchor">
<h2>Readability</h2>
</a>
</div>
<p>Reading and understanding APL code is more difficult than in other programming languages due to the higher abstraction level and the power of APL‚Äôs primitives. However, as long as you have at least one example with correct arguments, it‚Äôs always possible to decipher the code.</p>
<p>Things can become very nasty indeed if an application crashes because inappropriate data arrives at your function. However, before you can figure out whether the data is appropriate or not you need to understand the code ‚Äì a chicken-egg problem.</p>
<p>That‚Äôs when test cases can be very useful as well because they demonstrate which data a function is expected to process. It also emphasises why it is important to have test cases for all the different types of data (or parameters) a function is supposed to process. In this respect test cases should be exhaustive.</p>
<div class="h_tag">
<a href="#Write-better" id="Write-better" class="autoheader_anchor">
<h3>Write better</h3>
</a>
</div>
<p>Writing functions with a view to passing formal tests will encourage you to write in <em>functional style</em>. In pure functional style, a function reads only the information in its arguments and writes only its result. No side effects or references.</p>
<pre><code>  ‚àá Z‚Üêmean R;r
   [1] Z‚Üê((+/r)√∑‚â¢r‚Üê,R)
  ‚àá</code></pre>
<p>In contrast, this line from <code>TxtToCsv</code> reads a value from a namespace external to the function (<code>EXIT.APPLICATION_CRASHED</code>) and sets another: <code>#.ErrorParms.returnCode</code>.</p>
<pre><code>    #.ErrorParms.returnCode‚ÜêEXIT.APPLICATION_CRASHED</code></pre>
<p>In principle, <code>TxtToCsv</code> <em>could</em> be written in purely functional style. References to classes and namespaces <code>#.HandleError</code>, <code>#.APLTreeUtils</code>, <code>#.FilesAndDirs</code>, <code>EXIT</code>, and <code>#.ErrorParms</code> could all be passed to it as arguments.</p>
<p>If those references ever varied ‚Äì for example, if there were an alternative namespace <code>ReturnCodes</code> sometimes used instead of <code>EXIT</code> ‚Äì that might be a useful way to write <code>TxtToCsv</code>.</p>
<p>But as things are, cluttering up the function‚Äôs <em>signature</em> ‚Äì its name and arguments ‚Äì with these references harms rather than helps readability. It is an example of the cure being worse than the disease.</p>
<p>You shouldn‚Äôt write <em>everything</em> in pure functional style but the closer you stick to it, the better your code will be, and the easier to test. Functional style goes hand in hand with good abstractions, and ease of testing.</p>
<div class="h_tag">
<a href="#Why-you-dont-want-to-write-tests" id="Why-you-dont-want-to-write-tests" class="autoheader_anchor">
<h2>Why you don‚Äôt want to write tests</h2>
</a>
</div>
<p>There is nothing magical about tests. Tests are just more code. The test code needs maintaining like everything else. If you refactor a portion of your application code, the associated tests need reviewing ‚Äì and possibly revising ‚Äì as well.</p>
<p>In programming, the number of bugs is generally a linear function of code volume. Test code is no exception to this rule. Your tests are both an aid to development and a burden on it.</p>
<p>You want tests for everything you think might break, but no more tests than you need.</p>
<p>Beck‚Äôs answer ‚Äì test anything you think might break ‚Äì provides useful insight. Some expressions are simple enough not to need testing. If you need the indexes of a vector of flags, you can <em>see</em> that <code>{‚çµ/‚ç≥‚â¢‚çµ}</code> [<a href="#fnref5" class="footnote_link"><sup>5</sup></a>] will find them. It‚Äôs as plain as <code>2+2</code> making four. You don‚Äôt need to test that.</p>
<p>APL‚Äôs scalar extension and operators such as <em>outer product</em> allow you to replace nested loops (a common source of error) with expressions which don‚Äôt need tests. The higher level of abstraction enabled by working with collections allows not only fewer code lines but also fewer tests.</p>
<p>Time for a new version of MyApp. Make a copy of <code>Z:\code\v07</code> as <code>Z:\code\v08</code>.</p>
<div class="h_tag">
<a href="#Setting-up-the-test-environment" id="Setting-up-the-test-environment" class="autoheader_anchor">
<h2>Setting up the test environment</h2>
</a>
</div>
<p>We‚Äôll need the <code>Tester</code> class from the APLTree library. And a namespace of tests, which we‚Äôll dub <code>#.Tests</code>.</p>
<p>Create <code>Z:\code\v08\Tests.dyalog</code>:</p>
<pre><code>    :Namespace Tests

    :EndNamespace</code></pre>
<p>Save this as <code>Z:\code\v08\Tests.dyalog</code> and include both scripts in the <abbr title="File with the extension 'dyapp' that contains 'Load' and 'Run' commands in order to put together an APL application">DYAPP</abbr>:</p>
<pre><code>    Target #
    Load ..\AplTree\APLTreeUtils
    Load ..\AplTree\FilesAndDir
    Load ..\AplTree\HandleError
    Load ..\AplTree\IniFiles
    Load ..\AplTree\Logger
<span class="leanpub_code">    Load ..\AplTree\Tester
</span>    Load Constants
    Load Utilities
<span class="leanpub_code">    Load Tests
</span>    Load MyApp
    Run MyApp.Start 'Session'</code></pre>
<p>Run the <abbr title="File with the extension 'dyapp' that contains 'Load' and 'Run' commands in order to put together an APL application">DYAPP</abbr> to build the workspace. In the session you might want to execute <code>]ADoc #.Tester</code> to see the documentation for the Tester class.</p>
<div class="h_tag">
<a href="#Unit-and-functional-tests" id="Unit-and-functional-tests" class="autoheader_anchor">
<h2>Unit and functional tests</h2>
</a>
</div>

<div class="leanpub">
<img src="https://download.aplwiki.com/LeanPub/Images/information.png" alt="Information">
<div>
<p>Unit tests tell a developer that the code is <em>doing things right</em>; functional tests tell a developer that the code is <em>doing the right things</em>.</p>
</div>
</div>

<p>It‚Äôs a question of perspective. Unit tests are written from the programmer‚Äôs point of view. Does the function or method return the correct result for given arguments?</p>
<p>Functional tests, on the other hand, are written from the user‚Äôs point of view. Does the software do what its <em>user</em> needs it to do?</p>
<p>Both kinds of tests are important. If you are a professional programmer you need a user representative to write functional tests. If you are a domain-expert programmer [<a href="#fnref3" class="footnote_link"><sup>3</sup></a>] you can write both.</p>
<p>In this chapter we'll tackle unit tests.</p>
<div class="h_tag">
<a href="#Speed" id="Speed" class="autoheader_anchor">
<h2>Speed</h2>
</a>
</div>
<p>Unit tests should execute <em>fast</em>: developers often want to execute them even when still working on a project in order to make sure that they have not broken anything, or to find out what they broke. If executing the test suite takes too long it defeats the purpose.</p>
<p>Sometimes it cannot be avoided that tests take quite a while, for example when testing GUIs. In that case it might be an idea to create a group of tests that comprehend not all, but just the most important ones.</p>
<p>Those can then be executed while actually working on the code base while the full-blown test suite is only executed every now and then, maybe only before checking in the code.</p>
<div class="h_tag">
<a href="#Preparing-helpers" id="Preparing-helpers" class="autoheader_anchor">
<h2>Preparing: helpers</h2>
</a>
</div>
<p>The first thing we are going to do is to establish a number of helpers in <code>Tests</code> that the <code>Tester</code> class provides. We can simply call <code>Tester.EstablishHelpersIn</code> and provide a ref to the namespace hosting our test cases as right argument:</p>
<pre><code>    )cs #
#
    Tester.EstablishHelpersIn #.Tests
    #.Tests.‚éïnl 3
FailsIf
G
GoToTidyUp
L
ListHelpers
PassesIf
Run
RunBatchTests
RunBatchTestsInDebugMode
RunDebug
RunThese
‚àÜFailed
‚àÜInactive
‚àÜLinuxOnly
‚àÜLinuxOrMacOnly
‚àÜLinuxOrWindowsOnly
‚àÜMacOnly
‚àÜMacOrWindowsOnly
‚àÜNoAcreTests
‚àÜNoBatchTest
‚àÜOK
‚àÜWindowsOnly</code></pre>
<p>The helpers can be categorized:</p>
<ul>
<li>Those starting their names with a <code>‚àÜ</code> character are niladic functions that return a result. They act like constants in other programming languages. APL does not have constants, but they can be emulated with niladic functions. (Strictly speaking, they are not helpers)</li>
<li>Those starting their names with <code>Run</code> are used to run all or selected test cases in slightly different scenarios.</li>
<li><code>FailsIf</code>, <code>PassesIf</code> and <code>GoToTidyUp</code> are used for flow control.</li>
<li>Miscellaneous</li>
</ul>
<p>Some of the helpers (<code>G</code>, <code>L</code> and <code>ListHelpers</code>) are just helpful while others, like all the <code>Run*</code> functions and the flow control functions, are essential. We need them to be around before we can execute any test case.</p>
<p>The fact that we had to establish them with a function call upfront contradicts this. But there is an escape route: we add a line to the <abbr title="File with the extension 'dyapp' that contains 'Load' and 'Run' commands in order to put together an APL application">DYAPP</abbr>:</p>
<pre><code>...
Run #.MyApp.SetLX ‚ç¨
<span class="leanpub_code">Run #.Tester.EstablishHelpersIn #.Tests
</span></code></pre>
<p>Of course we don‚Äôt need this when the <abbr title="File with the extension 'dyapp' that contains 'Load' and 'Run' commands in order to put together an APL application">DYAPP</abbr> is supposed to assemble the workspace for a productive environment; we will address this problem later.</p>
<p>We will discuss all helpers in detail, and we start with the flow control helpers.</p>
<div class="h_tag">
<a href="#Flow-control-helpers" id="Flow-control-helpers" class="autoheader_anchor">
<h3>Flow control helpers</h3>
</a>
</div>
<p>Let‚Äôs look at an example: <code>FailsIf</code> takes a boolean right argument and returns either <code>0</code> in case the right argument is <code>1</code> or an empty vector in case the right argument is <code>0</code>:</p>
<pre><code>      FailsIf 1
0
      FailsIf 0

      ‚ç¥FailsIf 0
0</code></pre>
<p>That means that the statement <code>‚ÜíFailsIf 1</code> will jump to 0, exiting the function carrying the statement.</p>
<p>Since GoTo statements are rarely used these days because under most circumstances control structures are far better, it is probably worthwhile to mention that <code>‚Üí‚ç¨</code> ‚Äì as well as <code>‚Üí''</code> ‚Äì makes the interpreter carry on with the next line.</p>
<p>In other words the function just carries on. That‚Äôs exactly what we want when the right argument of <code>FailsIf</code> is a <code>0</code> because in that case the test has not failed.</p>
<p><code>PassesIf</code> is exactly the same thing but just with a negated argument: it returns a <code>0</code> when the right argument is <code>0</code> and an empty vector in case the right argument is <code>1</code>.</p>
<p><code>GoToTidyUp</code> is a special case. It returns an empty vector when the right argument is <code>0</code>. If the right argument is <code>1</code> by convention the function that calls it has a line labelled <code>‚àÜTidyUp</code>; the line number of that label is then returned.</p>
<p>This is useful in case a test function needs to do some cleaning up, no matter whether it has failed or not. Imagine you need a temporary file for a test but want to delete it after carrying out the test case. In that case the bottom of your test function might look like this:</p>
<pre><code>...
‚àÜTidyUp:
    #.FilesAndDirs.DeleteFile tempFilename</code></pre>
<p>When everything goes according to plan the function would eventually execute these lines anyway, but when a test case fails you need this:</p>
<pre><code>    ‚ÜíGoToTidyUp expected‚â¢result</code></pre>
<p>Like <code>FailsIf</code> the test function would just carry on in case <code>expected‚â¢result</code> returns a <code>0</code> but jump to the label <code>‚àÜTidyUp</code> in case the test fails (=the condition is true).</p>
<p>But why are we using functions for all this anyway? We could do without, couldn‚Äôt we? Yes, so far we could, but there is just one more thing.</p>
<div class="h_tag">
<a href="#Writing-unit-tests" id="Writing-unit-tests" class="autoheader_anchor">
<h2>Writing unit tests</h2>
</a>
</div>
<p>We have automated the way the helpers are established in <code>Tests</code>. Now we are ready to implement the first test case.</p>
<p>Utilities are a good place to start writing tests. Many utility functions are simply names assigned to common expressions. Other utilities encapsulate complexity, making similar transformations of different arguments.</p>
<p>We‚Äôll start with <code>map</code> in <code>#.Utilities</code>. We know by now that in general it works although even that needs confirmation by a test of course. What we don‚Äôt know yet is whether it works under all circumstances. We also need to ensure it complains when given inappropriate arguments.</p>
<p>To make writing test cases as easy as possible you can ask <code>Tester</code> to provide a test case template.</p>
<pre><code>    ‚éï‚Üê‚ç™#.Tester.GetTestFnsTemplate
  R‚ÜêTest_000(stopFlag batchFlag);‚éïTRAP
 ‚çù Model for a test function.
  ‚éïTRAP‚Üê(999 'C' '. ‚çù Deliberate error')(0 'N')
  R‚Üê‚àÜFailed

 ‚çù Preconditions...
 ‚çù ...

  ‚ÜíPassesIf 1‚â°1
  ‚ÜíFailsIf 1‚â¢1
  ‚ÜíGoToTidyUp 1‚â¢1
  R‚Üê‚àÜOK

 ‚àÜTidyUp: ‚çù Clean up after this label
           ‚çù ...</code></pre>
<p>The template covers all possibilities, and we will discuss all of them. However, for the time being we want to keep it simple, so we will delete quite a lot and also add three more functions:</p>
<pre><code>:Namespace Tests
‚éïIO‚Üê1 ‚ãÑ ‚éïML‚Üê1
‚àáInitial
  U‚Üê##.Utilities ‚ãÑ F‚Üê##.FilesAndDirs ‚ãÑ A‚Üê##.APLTreeUtils
‚àá
‚àá R‚ÜêTest_001(stopFlag batchFlag);‚éïTRAP
 ‚çù Is the length of the left argument of the `map` function checked?
  ‚éïTRAP‚Üê(999 'C' '. ‚çù Deliberate error')(0 'N')
  R‚Üê‚àÜFailed
  :Trap 5
      {}(‚äÇ‚éïA)U.map'APL is great'
      ‚ÜíFailsIf 1
  :Else
      .
  :EndTrap
  R‚Üê‚àÜOK
‚àá
‚àá {r}‚ÜêGetHelpers
  r‚Üê##.Tester.EstablishHelpersIn ‚éïTHIS
‚àá
‚àá Cleanup dummy
  ‚éïEX¬®'AFU'
‚àá
:EndNamespace</code></pre>
<p>What we changed:</p>
<ul>
<li>We renamed the template from <code>Test_000</code> to <code>Test_001</code>.</li>
<li>We described in line 1 as thoroughly as possible what the test case is doing. The reason is that this line is later the only way to tell this test case from any other.
<p>In other words, it is really important to get this right. If you cannot describe in a single line what the test case is doing, it may be doing too much.</p></li>
<li>We set <code>‚éïTRAP</code> so that any error 999 will stop the interpreter with a deliberate error; we will soon see why and what for.</li>
<li>We also localise <code>‚éïTRAP</code> so that any error 999 has an effect only within the test function. In fact, any error other than 999 is passed through with the <code>N</code> option in order to allow traps further up the stack to take control.</li>
<li>We initialise the explicit result <code>R</code> by assigning the value returned by the niladic function <code>‚àÜFailed</code>. That allows us simply to leave the function in case a test fails: the result will then tell.</li>
<li>We trap the call to <code>map</code>, which we expect to fail with a length error because we provide a scalar as left argument.</li>
<li>In case there is no error we call the function <code>‚àÜFailsIf</code> and provide a <code>1</code> as right argument. That makes <code>‚àÜFailsIf</code> return a <code>0</code> and therefore leave <code>Test_001</code>.</li>
</ul>
<p>You might have noticed we address, say, <code>Utilities</code> with <code>##.Utilities</code> rather than <code>#.Utilities</code>. Making this a habit is a good idea: currently it does not make a difference, but when you later decide to move everything in <code>#</code> into, say, a namespace <code>#.Container</code> (you never know!) then <code>##.</code> would still work while <code>#.</code> wouldn't.</p>
<p>The <code>:Else</code> part is not ready yet; the full stop will prevent the test function from carrying on when we get there.</p>
<p>Notes:</p>
<ul>
<li>We also added a function <code>GetHelpers</code> to the script. The reason is that the helpers will disappear as soon as we fix the <code>Test</code> script. And we are going to fix it whenever we change something or add a new test case. Therefore we need an easy way to get them back: <code>GetHelpers</code> to the rescue.</li>
<li>The function <code>Initial</code> will be executed by the test framework before any test function is executed. This can be used to initialise stuff that all (or many) test cases need. Here we establish the references <code>A</code> (for the <code>APLTreeUtils</code> module), <code>F</code> (for the <code>FilesAndDirs</code> module) and <code>U</code> (for the <code>Utilities</code> module).
<p><code>Initial</code> relies on naming conventions; if there is a function in scope with that name, it will be executed. More later.</p></li>
<li>The function <code>Cleanup</code> will be executed by the test framework after all test functions have been executed. This can be used to clean up stuff that‚Äôs no longer needed. Here we delete the references <code>A</code>, <code>F</code> and <code>U</code>. More later.</li>
</ul>

<div class="leanpub_A">
<h3>Ordinary namespaces versus scripted ones</h3>
<p>There‚Äôs a difference between an ordinary namespace and a scripted namespace: imagine you've called <code>#.Tester.EstablishHelpersIn</code> within an ordinary namespace.</p>
<p>Now you change/add/delete test functions; that would have no effect on anything else in that namespace. In other words, the helpers would continue to exist.</p>
<p>When you change a namespace script, on the other hand, the namespace is re-created from the script, and that means that our helpers will disappear because they are not a part of the <code>Tests</code> script.</p>
</div>

<p>Let‚Äôs execute our test case. We do this by running the <code>Run</code> method first:</p>
<pre><code>Run
--- Test framework "Tester" version 3.9.0 from yyyy-mm-dd ---------------------------------
Searching for INI file Testcases.ini
  ...not found
Searching for INI file testcases_{compuetername}.ini
  ...not found
Looking for a function "Initial"...
  "Initial" found and successfully executed
--- Tests started at YYYY-MM-DD hh:mm:ss on #.Tests ---------------------------------------
# Test_001 (1 of 1) : Is the length of the left argument of the `map` function checked?
 ------------------------------------------------------------------------------------------
   1 test case executed
   0 test cases failed
   1 test case broken
Time of execution recorded on variable #.Tests.TestCasesExecutedAt in: YYYY-MM-DD hh:mm:ss
Looking for a function "Cleanup"...
  Function "Cleanup" found and executed.
*** Tests done</code></pre>
<p>That‚Äôs what we expect.</p>

<div class="leanpub">
<img src="https://download.aplwiki.com/LeanPub/Images/information.png" alt="Information">
<div>
<p>Note that there are <abbr title="File with the extension 'ini' containing configuration data">INI</abbr> files mentioned. Ignore this for the time being; we will discuss this later on.</p>
</div>
</div>

<div class="leanpub_A">
<h3>What is a test case?!</h3>
<p>You might wonder how <code>Run</code> established what is a test case and what isn‚Äôt: that‚Äôs achieved by naming conventions. All test functions start their names with <code>Test_</code>. After that there are two possibilities:</p>
<ol start="1">
<li>In the simple case the <code>_</code> is followed by nothing but digits. All these qualify as test cases: <code>Test_1</code>, <code>Test_01</code>, <code>Test_001</code> and so on. (<code>Test_01A</code> however does not.)</li>
<li>If you have a large number of test cases you most probably want to group them. You can insert a group name between two underscores, followed by one or more digits. So <code>Test_map_1</code> is recognized as a test case, and so is <code>Test_Foo_9999</code>. <code>Test_Foo_Goo_1</code> however is not.</li>
</ol>
</div>

<p>What if we want to look into a broken or failing test case? Of course in our current scenario ‚Äì which is extremely simple ‚Äì we could just trace into <code>Test_001</code> and find out what‚Äôs going on, but if we take advantage of the many features the test framework offers, we cannot do this. (Soon it will become clear why.)</p>
<p>However, there is a way to do this no matter whether the scenario is simple, reasonably complex or extremely complex: we call <code>RunDebug</code>:</p>
<pre><code>RunDebug 0
--- Test framework "Tester" version 3.9.0 from yyyy-mm-dd -------
Searching for INI file testcases_{computername}.ini
  ...not found
Searching for INI file Testcases.ini
  ...not found
Looking for a function "Initial"...
  "Initial" found and successfully executed
--- Tests started at YYYY-MM-DD hh:mm:ss on #.Tests -------------
SYNTAX ERROR
      . ‚çù Deliberate error
     ‚àß
      )si
#.Tests.Test_001[6]*
‚çé
#.Tester.ExecuteTestFunction[6]
#.Tester.ProcessTestCases[6]
#.Tester.Run__[39]
#.Tester.RunDebug[17]
#.Tests.RunDebug[3]</code></pre>
<p>It stopped in line 6. Obviously the call to <code>FailsIf</code> has something to do with this, and so has the <code>‚éïTRAP</code> setting because apparently that‚Äôs where the ‚ÄúDeliberate error‚Äù comes from.</p>
<p>This is indeed the case. All three flow-control functions, <code>FailIf</code>, <code>PassesIf</code> and <code>GoToTidyUp</code> check whether they are running in debug mode; if so, rather than returning a result that indicates a failing test case, they <code>‚éïSIGNAL 999</code>, which is then caught by the <code>‚éïTRAP</code>, which in turn first prints <code>‚çù Deliberate error</code> to the session and then hands over control to the user.</p>
<p>You can now investigate variables or start the Tracer or take any other reasonable measure to investigate the problem.</p>
<p>The difference between <code>Run</code> and <code>RunDebug</code> is the setting of the first of the two flags provided as right argument to the test function: <code>stopFlag</code>. This is <code>0</code> when <code>Run</code> executes the test cases, but it is <code>1</code> when <code>RunDebug</code> is in charge. The three flow-control functions <code>FailsIf</code>, <code>PassesIf</code> and <code>GoToTidyUp</code> all honour <code>stopFlag</code> ‚Äì that‚Äôs how it works.</p>
<p>Now sometimes you don‚Äôt want the test function to go to the point where the error actually appears, for example if the test function does a lot of precautioning, and you want to check this upfront because there might be something wrong with it, causing the failure. In such a case you want to investigate the test function as early as possible.</p>
<p>Note that so far we passed a <code>0</code> as right argument to <code>RunDebug</code>. If we pass a <code>1</code> instead, then the test framework would stop just before executing the actual test case:</p>
<pre><code>      RunDebug 1
--- Test framework "Tester" version 3.9.0 from YYYY-MM-DD -------
Searching for INI file Testcases.ini
  ...not found
Searching for INI file testcases_APLTEAM2.ini
  ...not found
Looking for a function "Initial"...
  "Initial" found and successfully executed
--- Tests started at YYYY-MM-DD hh:mm:ss on #.Tests -------------

ExecuteTestFunction[6]
      )si
#.Tester.ExecuteTestFunction[6]*
#.Tester.ProcessTestCases[6]
#.Tester.Run__[39]
#.Tester.RunDebug[17]
#.Tests.RunDebug[3]</code></pre>
<p>Note that it has however executed the <code>Initial</code> function.</p>
<p>You could now trace into <code>Test_001</code> and investigate. Instead, enter <code>‚Üí0</code>. You should see something like this:</p>
<pre><code>* Test_001 (1 of 1) : Is the length of the left argument of the `map` function checked?
 ----------------------------------------------------------------------------------------
   1 test case executed
   1 test case failed
   0 test cases broken
Time of execution recorded on variable #.Tests.TestCasesExecutedAt in: YYYY-MM-DD hh:mm:ss
Looking for a function "Cleanup"...
  Function "Cleanup" found and executed.
*** Tests done</code></pre>
<p>Let‚Äôs have <code>map</code> check its left argument:</p>
<pre><code>:Namespace Utilities
      map‚Üê{
<span class="leanpub_code">          (,2)‚â¢‚ç¥‚ç∫:'Left argument is not a two-element vector'‚éïSIGNAL 5
</span>          (old new)‚Üê‚ç∫
          nw‚Üê‚à™‚çµ
          (new,nw)[(old,nw)‚ç≥‚çµ]
      }
:EndNamespace</code></pre>
<p>Now run <code>RunDebug 1</code>. Trace into <code>Test_001</code> and watch whether now any error 5 (LENGTH ERROR) is trapped, You should end up on line 8 of <code>Test_001</code>. Exchange the full stop by:</p>
<pre><code>    ‚ÜíPassesIf'Left argument is not a two-element vector'‚â°‚éïDMX.EM</code></pre>

<div class="leanpub_A">
<h3>‚éïDM versus ‚éïDMX</h3>
<p>You have always used <code>‚éïDM</code>, and it was fine, right? No need to switch to the (relatively) new <code>‚éïDMX</code>, right? Well, the problem with <code>‚éïDM</code> is that it is not thread-safe, while <code>‚éïDMX</code> is. That‚Äôs why we suggest you stop using <code>‚éïDM</code> and use just <code>‚éïDMX</code>. It also provides more, and more precise, information.</p>
</div>

<p>This checks whether the error message is what we expect. Trace through the test function and watch what it is doing. After having left the test function you may click the green triangle in the Tracer. (Continues execution of all threads.)</p>
<p>Now what if you‚Äôve executed, say, not one but 300 test cases with <code>Run</code>, and just one failed, say number 289? You expected them all to succeed; now you need to check on the failing one.</p>
<p>Calling <code>Run</code> as well as <code>RunDebug</code> would always execute <em>all</em> test cases found. The function <code>RunThese</code> allows you to run just the specified test function(s):</p>
<pre><code>      RunThese 1
--- Test framework "Tester" version 3.5.0 from 2017-07-16 --------------------------------
Searching for INI file Testcases.ini
  ...not found
Searching for INI file testcases_APLTEAM2.ini
  ...not found
Looking for a function "Initial"...
  "Initial" found and successfully executed
--- Tests started at YYYY-MM-DD hh:mm:ss on #.Tests --------------------------------------
  Test_001 (1 of 1) : Process a single file with .\MyApp.exe
 -----------------------------------------------------------------------------------------
   1 test case executed
   0 test cases failed
   0 test cases broken
Time of execution recorded on variable #.Tests.TestCasesExecutedAt in: YYYY-MM-DD hh:mm:ss
Looking for a function "Cleanup"...
  Function "Cleanup" found and executed.
*** Tests done</code></pre>
<p>This would run just test case number 1. If you specify it as <code>¬Ø1</code> it would stop just before actually executing the test case.</p>
<p>Same as before since we have just one test function yet but take our word for it, it would execute just <code>Test_001</code> no matter how many other test cases there are.</p>
<p>We have discussed the functions <code>Run</code>, <code>RunDebug</code> and <code>RunThese</code>. That leaves <code>RunBatchTests</code> and <code>RunBatchTestsInDebugMode</code>; what are they for?</p>
<p>Imagine a test that would either require an enormous amount of effort to implement ‚Äì or alternatively you just build something up and ask the human in front of the monitor: <em>Does this look alright?</em>.</p>
<p>That‚Äôs certainly <em>not</em> a batch test case because it needs a human sitting in front of the monitor. If you know upfront that there won‚Äôt be a human paying attention then you can prevent non-batch test cases from being executed by calling either <code>RunBatchTests</code> or <code>RunBatchTestsInDebugMode</code>.</p>
<p>How does this work? We already learned that <code>stopFlag</code>, the first of the two flags passed to any test case as the right argument, governs whether any errors are trapped or not.</p>
<p>The second flag is called <code>batchFlag</code>, and that gives you an idea of what it‚Äôs good for. If you have a test that interacts with a user (i.e. cannot run without a human) then your test case would typically look like this:</p>
<pre><code> R‚ÜêTest_001(stopFlag batchFlag);‚éïTRAP
‚çù Check ...
 ‚éïTRAP‚Üê(999 'C' '. ‚çù Deliberate error')(0 'N')
 R‚Üê‚àÜFailed
 :If batchFlag
     ‚çù perform the test
     R‚Üê‚àÜOK
 :Else
     R‚Üê‚àÜNoBatchTest
 :EndIf</code></pre>
<p>The test function checks the <code>batchFlag</code> and does not execute the test as such because it is not suitable for batch testing.</p>
<p>One can argue whether the test case we have implemented makes much sense, but it allowed us to investigate the basic features of the test framework. We are now ready to investigate the more sophisticated features.</p>
<p>Of course we also need a test case that checks whether <code>map</code> does what it‚Äôs supposed to do when appropriate arrays are passed as arguments, therefore we add this to <code>Tests</code>:</p>
<pre><code>Namespace Tests

‚àá R‚ÜêTest_001(stopFlag batchFlag);‚éïTRAP
...
‚àá

‚àá R‚ÜêTest_002(stopFlag batchFlag);‚éïTRAP;Config;MyLogger
  ‚çù Check whether `map` works fine with appropriate data
  ‚éïTRAP‚Üê(999 'C' '. ‚çù Deliberate error')(0 'N')
  R‚Üê‚àÜFailed
  (Config MyLogger)‚Üê##.MyApp.Initial ‚ç¨
  ‚ÜíFailsIf'APL IS GREAT'‚â¢Config.Accents U.map A.Uppercase'APL is great'
  ‚ÜíFailsIf'U√üU'‚â¢Config.Accents U.map A.Uppercase'√º√ü√ú'
  R‚Üê‚àÜOK
‚àá
...</code></pre>

<div class="leanpub">
<img src="https://download.aplwiki.com/LeanPub/Images/information.png" alt="Information">
<div>
<p>Note how using the references <code>U</code> and <code>A</code> here simplifies the code greatly.</p>
</div>
</div>

<p>Now we try to execute the newly introduced second test case:</p>
<pre><code>      #.Tests.GetHelpers
      RunThese 2
--- Test framework "Tester" version 3.9.0 from YYYY-MM-DD ----------------
Searching for INI file testcases_{computername}.ini
  ...not found
Searching for INI file Testcases.ini
  ...not found
Looking for a function "Initial"...
  "Initial" found and successfully executed
--- Tests started at YYYY-MM-DD hh:mm:ss on #.Tests ----------------------
  Test_002 (1 of 1) : Check whether `map` works fine with appropriate data
 -------------------------------------------------------------------------
   1 test case executed
   0 test cases failed
   0 test cases broken</code></pre>
<p>Works fine. Excellent.</p>
<p>Now let‚Äôs make sure the workhorse is doing okay; for this we add another test case:</p>
<pre><code>:Namespace Tests
...
    ‚àá R‚ÜêTest_002(stopFlag batchFlag);‚éïTRAP
...
    ‚àá R‚ÜêTest_003(stopFlag batchFlag);‚éïTRAP;Config;MyLogger
    ‚çù Test whether `TxtToCsv` handles a non-existing file correctly
      ‚éïTRAP‚Üê(999 'C' '. ‚çù Deliberate error')(0 'N')
      R‚Üê‚àÜFailed
      rc‚Üê##.MyApp.TxtToCsv 'This_file_does_not_exist'
      ‚ÜíFailsIf ##.MyApp.EXIT.SOURCE_NOT_FOUND‚â¢rc
      R‚Üê‚àÜOK
    ‚àá
...</code></pre>
<p>Let‚Äôs call this test:</p>
<pre><code>      )CS #.Tests
#.Tests
      GetHelpers
      RunThese 3
...
VALUE ERROR
TxtToCsv[4] MyLogger.Log'Source: ',fullfilepath
            ‚àß</code></pre>
<p>Oops. <code>MyLogger</code> is undefined. In the envisaged use in production, it is defined by, and local to, <code>StartFromCmdLine</code>. That design followed Occam‚Äôs Razor[<a href="#fnref4" class="footnote_link"><sup>4</sup></a>]: (entities are not to be needlessly multiplied) in keeping the log object in existence only while needed. But it now prevents us from testing <code>TxtToCsv</code> independently. So we‚Äôll refactor:</p>
<pre><code>:Namespace Tests
...
    ‚àá R‚ÜêTest_003(stopFlag batchFlag);‚éïTRAP
    ‚çù Test whether `TxtToCsv` handles a non-existing file correctly
      ‚éïTRAP‚Üê(999 'C' '. ‚çù Deliberate error')(0 'N')
      R‚Üê‚àÜFailed
<span class="leanpub_code">      ##.MyApp.(Config MyLogger)‚Üê##.MyApp.Initial ‚ç¨
</span>      rc‚Üê##.MyApp.TxtToCsv 'This_file_does_not_exist'
      ‚ÜíFailsIf ##.MyApp.EXIT.SOURCE_NOT_FOUND‚â¢rc
      R‚Üê‚àÜOK
    ‚àá
...</code></pre>
<p>Note that now both <code>Config</code> and <code>MyLogger</code> exist within <code>MyApp</code>, not in <code>Tests</code>. Therefore we don't even have to keep them local within <code>Test_003</code>.</p>
<p>Let‚Äôs try again:</p>
<pre><code>      RunThese 3
--- Test framework "Tester" version 3.9.0 from YYYY-MM-DD -------------------------
Searching for INI file testcases_{computername}.ini
  ...not found
Searching for INI file Testcases.ini
  ...not found
Looking for a function "Initial"...
  "Initial" found and successfully executed
--- Tests started at 2017-03-22 15:56:41 on #.Tests -------------------------------
  Test_003 (1 of 1) : Test whether `TxtToCsv` handles a non-existing file correctly
 ----------------------------------------------------------------------------------
   1 test case executed
   0 test cases failed
   0 test cases broken
Time of execution recorded on variable #.Tests.TestCasesExecutedAt: YYYY-MM-DD hh:mm:ss
Looking for a function "Cleanup"...
  Function "Cleanup" found and executed.</code></pre>
<p>Clearly we need to have one test case for every result the function <code>TxtToCsv</code> might return but we leave that as an exercise to you. We have more important test cases to write: we want to ensure whenever we create a new version of the <abbr title="Executable file with the extension 'exe'">EXE</abbr> that it will keep working.</p>
<p>Let‚Äôs rename the test functions we have so far:</p>
<ul>
<li><code>Test_001</code> becomes <code>Test_map_01</code></li>
<li><code>Test_002</code> becomes <code>Test_map_02</code></li>
<li><code>Test_003</code> becomes <code>Test_TxtToCsv_01</code></li>
</ul>
<p>The new test cases we are about to add will be named <code>Test_exe_01</code>, etc. For our application we could manage without grouping, but once you have more than, say, 20 test cases, grouping is a must. So we demonstrate now how this can be done.</p>
<div class="h_tag">
<a href="#The-Initial-function" id="The-Initial-function" class="autoheader_anchor">
<h3>The ‚ÄúInitial‚Äù function</h3>
</a>
</div>
<p>We've already introduced a function <code>Initial</code> for establishing the references <code>A</code>, <code>U</code> and <code>F</code> before we execute any test cases. For testing the <abbr title="Executable file with the extension 'exe'">EXE</abbr> we need a folder where we can store files temporarily. We add this to <code>Initial</code>:</p>
<pre><code>:Namespace Tests
‚éïIO‚Üê1 ‚ãÑ ‚éïML‚Üê1
<span class="leanpub_code"> ‚àá R‚ÜêInitial;list;rc
</span>   U‚Üê##.Utilities ‚ãÑ F‚Üê##.FilesAndDirs ‚ãÑ A‚Üê##.APLTreeUtils
<span class="leanpub_code">   ‚àÜPath‚ÜêF.GetTempPath,'MyApp_Tests'
   F.RmDir ‚àÜPath
   'Create!'F.CheckPath ‚àÜPath
   list‚Üê‚äÉF.Dir'..\..\texts\en\*.txt'
   rc‚Üêlist F.CopyTo ‚àÜPath,'\'
   :If ~R‚Üê0‚àß.=‚äÉrc
       ‚éï‚Üê'Could not create ',‚àÜPath
   :EndIf
</span> ‚àá
...</code></pre>
<p><code>Initial</code> does not have to return a result but if it does it must be a Boolean. For ‚Äúsuccess‚Äù it should return a <code>1</code> and otherwise a <code>0</code>. If it does return <code>0</code> then no test cases are executed, but if there is a function <code>Cleanup</code> it will be executed. Therefore <code>Cleanup</code> should be ready to clean up in case <code>Initial</code> was only partly or not at all successful.</p>
<p>We have changed <code>Initial</code> so that it now returns a result because copying the files over might fail for all sorts of reasons ‚Äì and we cannot do without them.</p>
<p><code>Initial</code> may or may not accept a right argument. If it does it will be passed a namespace that holds all the parameters.</p>
<p>What we do in <code>Initial</code>, apart from creating the references:</p>
<ul>
<li>Create a global variable <code>‚àÜPath</code> which holds a path to a folder <code>MyApp_Tests</code> within the Windows temp folder.</li>
<li>Remove that folder, in case it persists from previously failing test cases.</li>
<li>Create it.</li>
<li>Get a list of all text files in the <code>texts\en\</code> folder.</li>
<li>Copy those files to our temporary test folder.</li>
<li>Check the return code of the copy operation; <code>R</code> gets 1 (indicating success) only if it was successful.</li>
</ul>

<div class="leanpub_A">
<h3>Machine-dependent initialisation</h3>
<p>What if you need to initialise something (say a database connection) but it depends on the machine the tests are executed on ‚Äì its IP address, user-id, password‚Ä¶?</p>
<p>The test framework looks for two different <abbr title="File with the extension 'ini' containing configuration data">INI</abbr> files in the current directory: First it looks for <code>testcase.ini</code>. It then tries to find <code>testcase_{computername}.ini</code>. <code>computername</code> here is what you get when you execute <code>‚ä£ 2 ‚éïnq # 'GetEnvironment' 'Computername'</code>.</p>
<p>If it finds any of them (or both) it instantiates the <code>IniFile</code> class as <code>INI</code> on these <abbr title="File with the extension 'ini' containing configuration data">INI</abbr> files within the namespace that hosts your test cases. In the case of a name clash, the setting in <code>testcase_{computername}.ini</code> prevails.</p>
</div>

<p>Now we are ready to test the <abbr title="Executable file with the extension 'exe'">EXE</abbr>; create it from scratch. Our first test case will process the file <code>ulysses.txt</code>:</p>
<pre><code>:Namespace Tests
...
    ‚àá R‚ÜêTest_exe_01(stopFlag batchFlag);‚éïTRAP;rc
      ‚çù Process a single file with .\MyApp.exe
      ‚éïTRAP‚Üê(999 'C' '. ‚çù Deliberate error')(0 'N')
      R‚Üê‚àÜFailed
     ‚çù Precautions:
      F.DeleteFile‚äÉF.Dir ‚àÜPath,'\*.csv' ‚çù (1)
      rc‚Üê##.Execute.Application'MyApp.exe ',‚àÜPath,'\ulysses.txt' ‚çù (2)
      ‚ÜíGoToTidyUp ##.MyApp.EXIT.OK‚â†‚äÉrc ‚çù (3)
      ‚ÜíGoToTidyUp~F.Exists ‚àÜPath,'\ulysses.csv' ‚çù (4)
      R‚Üê‚àÜOK
     ‚àÜTidyUp:
      F.DeleteFile‚äÉF.Dir ‚àÜPath,'\*.csv' ‚çù (5)
    ‚àá
...</code></pre>
<p>Notes:</p>
<ol start="1">
<li>Ensure there are no CSVs in <code>‚àÜPath</code>.</li>
<li>Call the <abbr title="Executable file with the extension 'exe'">EXE</abbr> with <code>ulysses.txt</code> as a command line parameter.</li>
<li>Check the return code and jump to <code>‚àÜTidyUp</code> if it‚Äôs not what we expect.</li>
<li>Check whether there is now a file <code>ulysses.cvs</code> in <code>‚àÜPath</code>.</li>
<li>Clean up and delete (again) all CSV files in <code>‚àÜPath</code>.</li>
</ol>
<p>Let‚Äôs run our new test case:</p>
<pre><code>      GetHelpers
      RunThese 'exe'
--- Test framework "Tester" version 3.9.0 from yyyy-mm-dd --------------------
Searching for INI file Testcases.ini
  ...not found
Searching for INI file testcases_{computername}.ini
  ...not found
Looking for a function "Initial"...
  "Initial" found and successfully executed
--- Tests started at YYYY-MM-DD HH:MM:SS on #.Tests --------------------------
  Test_exe_01 (1 of 1) : Process a single file with .\MyApp.exe
 -----------------------------------------------------------------------------
   1 test cases executed
   0 test cases failed
   0 test cases broken
Time of execution recorded on variable #.Tests.TestCasesExecutedAt in: YYYY-MM-DD HH:MM:SS
Looking for a function "Cleanup"...
*** Tests done</code></pre>
<p>Note that instead of a test case number we have specified a group name as argument of <code>RunThese</code>. In such a case <code>RunThese</code> executes all test cases belonging to the group specified.</p>
<p>You can also mix group names with test case number as in <code>RunThese 'exe' (1 3)</code>. <code>RunThese</code> is tolerant and ignores test case numbers that do not exist.</p>
<p>We need one more test case:</p>
<pre><code>:Namespace Tests
...
‚àá R‚ÜêTest_exe_01(stopFlag batchFlag);‚éïTRAP;rc
...
‚àá R‚ÜêTest_exe_02(stopFlag batchFlag);‚éïTRAP;rc;listCsvs
  ‚çù Process all TXT files in a certain directory
  ‚éïTRAP‚Üê(999 'C' '. ‚çù Deliberate error')(0 'N')
  R‚Üê‚àÜFailed
  ‚çù Precautions:
  F.DeleteFile‚äÉF.Dir ‚àÜPath,'\*.csv'
  rc‚Üê##.Execute.Application'MyApp.exe ',‚àÜPath,'\'
  ‚ÜíGoToTidyUp ##.MyApp.EXIT.OK‚â†‚äÉrc
  listCsvs‚Üê‚äÉF.Dir ‚àÜPath,'\*.csv'
  ‚ÜíGoToTidyUp 1‚â†‚ç¥listCsvs
  ‚ÜíGoToTidyUp'total.csv'‚â¢A.Lowercase‚äÉ,/1‚Üì‚éïNPARTS‚äÉlistCsvs
  R‚Üê‚àÜOK
 ‚àÜTidyUp:
  F.DeleteFile‚äÉF.Dir ‚àÜPath,'\*.csv'
‚àá
...</code></pre>
<p>This one will process <em>all</em> TXTs in <code>‚àÜPath</code> and write a file <code>total.csv</code>. We check whether this is the case and we are done. Almost: in a real-world application we most likely would also check for a path that contains spaces in its name. We don‚Äôt do this, instead we execute the full test suite:</p>
<pre><code>      GetHelpers
      ‚éï‚Üê‚äÉRun
--- Test framework "Tester" version 3.9.0 from YYYY-MM-DD ----------------------------
Searching for INI file testcases_{computername}.ini
  ...not found
Searching for INI file Testcases.ini
  ...not found
Looking for a function "Initial"...
  "Initial" found and successfully executed
--- Tests started at YYYY-MM-DD hh:mm:dd on #.Tests ---------------------------------------
  Test_exe_01 (1 of 5) : Process a single file with .\MyApp.exe
  Test_exe_02 (2 of 5) : Process all TXT files in a certain directory
  Test_map_01 (3 of 5) : Check the length of the left argument
  Test_map_02 (4 of 5) : Check whether `map` works fine with appropriate data
  Test_TxtToCsv_01 (5 of 5) : Test whether `TxtToCsv` handles a non-existing file correctly
 ------------------------------------------------------------------------------------------
   5 test cases executed
   0 test cases failed
   0 test cases broken
Time of execution recorded on variable #.Tests.TestCasesExecutedAt in: YYYY-MM-DD hh:mm:ss
Looking for a function "Cleanup"...
  Function "Cleanup" found and executed.
0</code></pre>
<p>Note that the function <code>Run</code> prints its findings to the session but also returns a result. That‚Äôs a two-item vector:</p>
<ol start="1">
<li>Is a return code. <code>0</code> means OK.</li>
<li>Is a vector of vectors, identical to what‚Äôs printed to the session.</li>
</ol>
<div class="h_tag">
<a href="#Cleaning-up" id="Cleaning-up" class="autoheader_anchor">
<h3>Cleaning up</h3>
</a>
</div>
<p>Although we have been careful and made sure that every single test case cleans up after itself (in particular those that failed), we have not removed the directory that <code>‚àÜPath</code> points to. We add some code to the <code>Cleanup</code> function in order to achieve that:</p>
<pre><code>:Namespace Tests
...
‚àá Cleanup dummy
  ‚éïEX¬®'AFU'
<span class="leanpub_code">  :If 0&lt;‚éïNC'‚àÜPath'
      ##.FilesAndDirs.RmDir ‚àÜPath
      ‚éïEX '‚àÜPath'
  :EndIf
<span class="leanpub_code">‚àá

:EndNamespace</code></pre>
<p>This function now checks whether a global <code>‚àÜPath</code> exists. If so, the directory it points to is removed and the global variable deleted. The <code>Tester</code> framework checks whether there is a function <code>Cleanup</code>.</p>
<p>If so, the function is executed after the last test case has been executed. The function must be either monadic or niladic; if it is a monadic function the right argument will be <code>‚ç¨</code>. It must either return a shy result (ignored) or no result at all.</p>
<div class="h_tag">
<a href="#Markers" id="Markers" class="autoheader_anchor">
<h3>Markers</h3>
</a>
</div>
<p>We‚Äôve already mentioned elsewhere that it is useful to mark code in particular ways, like <code>‚çùFIXME‚çù</code> or <code>‚çùTODO‚çù</code>. It is an excellent idea to have a test case that checks for such markers. Before code makes it to a customer such strings should probably be removed from the code.</p>
<div class="h_tag">
<a href="#The-L-and-G-helpers" id="The-L-and-G-helpers" class="autoheader_anchor">
<h3>The ‚ÄúL‚Äù and ‚ÄúG‚Äù helpers</h3>
</a>
</div>
<p>Now that we have three groups we can take advantage of the <code>G</code> and the <code>L</code> helpers:</p>
<pre><code>      G
exe
map
TxtToCsv
      L''
 Test_exe_01       Process a single file with .\MyApp.exe
 Test_exe_02       Process all TXT files in a certain directory
 Test_map_01       Is the length of the left argument of the `map` function checked?
 Test_map_02       Check whether `map` works fine with appropriate data
 Test_TxtToCsv_01  Test whether `TxtToCsv` handles a non-existing file correctly
      L'ex'
 Test_exe_01  Process a single file with .\MyApp.exe
 Test_exe_02  Process all TXT files in a certain directory</code></pre>
<div class="h_tag">
<a href="#TestCasesExecutedAt" id="TestCasesExecutedAt" class="autoheader_anchor">
<h2>TestCasesExecutedAt</h2>
</a>
</div>
<p>Whenever the test cases were executed <code>Tester</code> notifies the time on a global variable <code>TestCasesExecutedAt</code> in the hosting namespace. This can be used in order to find out whether part of the code has been changed since the last time the cases were executed.</p>
<p>However, in order to do this, you have to make sure that the variable is either saved somewhere or added to the script <code>Tests</code>. For example, it could be handled by a cover function that calls any of <code>Tester</code>s <code>Run*</code> functions and then handle that variable.</p>
<div class="h_tag">
<a href="#Conclusion" id="Conclusion" class="autoheader_anchor">
<h2>Conclusion</h2>
</a>
</div>
<p>We have now a test suite available that allows us to make sure that everything still works whenever we want. Invaluable.</p>
<div class="h_tag">
<a href="#The-sequence-of-tests" id="The-sequence-of-tests" class="autoheader_anchor">
<h2>The sequence of tests</h2>
</a>
</div>
<p>Please note that there is always the possibility of dependencies between test cases, no matter how hard you try to avoid that. That might be due to a mistake or due to an unnoticed side effect.</p>
<p>That doesn‚Äôt mean that you shouldn‚Äôt aim for making all test cases completely independent from one another. A future version of <code>Tester</code> might have an option to shuffle the test cases before executing them. That would help find dependencies.</p>
<div class="h_tag">
<a href="#Testing-in-different-versions-of-Windows" id="Testing-in-different-versions-of-Windows" class="autoheader_anchor">
<h2>Testing in different versions of Windows</h2>
</a>
</div>
<p>When you wrote for yourself, your code needed to run only on the version of Windows you use yourself. To ship it as a product, you will support it on the versions your customers use.</p>
<p>You need to pick the versions of Windows you will support, and run your tests on all those versions. (If you are not already a fan of automated tests, you are about to become one.)</p>
<p>For this you will need one of:</p>
<ul>
<li>a test machine for each OS (version of Windows) you support. The machine might well ‚Äúlive‚Äù in the cloud.</li>
<li>a test machine and VM (virtual-machine) software.</li>
</ul>
<p>What VM software should you use? One of us has had good results with <em>Workstation Player</em> from <a href="http://www.vmware.com" class="external_link">VMware</a>.</p>
<p>If you use VM software you will save a <em>machine image</em> for each OS. Include in each machine image your preferred development tools, such as text editor and Dyalog APL. You will need to keep each machine image up to date with fixes and patches to its OS and your tools.</p>
<p>The machine images are large, at least 30 GB each. So you want several hundred gigabytes of fast SSD (solid-state drive) on your test machine. With this you should be able to get a machine image loaded in 20 seconds or less.</p>
<div class="h_tag">
<a href="#Testing-APLTree-modules" id="Testing-APLTree-modules" class="autoheader_anchor">
<h2>Testing APLTree modules</h2>
</a>
</div>
<p>By now we are using quite a number of modules from the APLTree project. Shouldn‚Äôt we test them as well? After all, if they break, our application will stop working! Well, there are pros and cons:</p>
<dl>
<dt>Pro</dt>
<dd><p class="first_dd">The modules have their own unit tests, and those are exhaustive. An update is published only after all the test cases have passed.</p></dd>
<dd><p>The modules are constantly adapted to new demands or changes in the environment, etc. Therefore a new version of Windows or Dyalog won‚Äôt break them, although you need to allow some time for this to happen. ‚ÄúSome time‚Äù just means that you cannot expect the APLTree modules to be ready on the day a new version of either Windows or Dyalog becomes available.</p></dd>
<dt>Contra</dt>
<dd>We cannot know whether those test cases cover the same environment/s (different versions of Windows, different versions of Dyalog, domain-managed network or not, network drives or not, multi-threaded versus single-threaded, you name it) our application will run in.</dd>
</dl>
<p>That suggests we should incorporate the tests the modules come with into our own test suite, although we are sure that not too many people/companies using modules from the APLTree library are actually doing this.</p>
<table style="font-size:xx-large; color:red;">
<tbody>
<tr>
<td>‚çùTODO‚çù</td>
</tr>
</tbody>
</table>
<p style="color:red;"><strong><em>We might want to change this because of Link or/and acre‚Ä¶</em></strong></p>
<p>It‚Äôs not difficult to do: every module has a workspace saved on GitHub that comes with everything needed to run the test cases.</p>
<p>All it requires is</p>
<ul>
<li>start Dyalog (<em>your</em> version of Dyalog that is)</li>
<li>load that workspace</li>
<li>execute <code>#.TestCases.Run</code> (because all modules of the APLTree library host their test cases in an ordinary (non-scripted) namespace</li>
<li>catch the result and return it with <code>‚éïOFF</code> to the calling environment: as long as it‚Äôs <code>0</code>, all is well</li>
</ul>
<p>If it‚Äôs not <code>0</code>:</p>
<ul>
<li>start your version of Dyalog</li>
<li>load the workspace of the module that has one or more failing test cases</li>
<li>run <code>#.TestCases.RunDebug 0</code> to investigate what went wrong</li>
</ul>
<div id="footnotes_div">
<hr>
<p><strong>Footnotes</strong></p>
<ol>
<li id="fnref1"><p>Kent Beck, in conversation with one of the authors.</p><a href="#fnref1" class="footnote_anchor"></a>
<li id="fnref2"><p>APL has no <em>string</em> datatype. We use the word as a casual synonym for <em>character vector</em>.</p><a href="#fnref2" class="footnote_anchor"></a>
<li id="fnref3"><p>An expert in the domain of the application rather than an expert programmer, but who has learned enough programming to write the code.</p><a href="#fnref3" class="footnote_anchor"></a>
<li id="fnref4"><p><em>Non sunt multiplicanda entia sine necessitate.</em></p><a href="#fnref4" class="footnote_anchor"></a>
<li id="fnref5"><p>With version 17.0 the same can be achieved with the new primitive <code>‚ç∏</code>.</p><a href="#fnref5" class="footnote_anchor"></a>
</ol>
</div>
</body>
</html>